function get_css(e,t,s){if(!document.styleSheets)return!1;e=e.toLowerCase(),t=t||0;for(var r=t;r<document.styleSheets.length;r++){{document.styleSheets[r]}if(css_rules=document.styleSheets[r].cssRules||document.styleSheets[r].rules,css_rules){var i=0;do if(css_rules[i].selectorText.toLowerCase()==e)return 1==s?(document.styleSheets[r].removeRule&&document.styleSheets[r].removeRule(i),document.styleSheets[r].deleteRule&&document.styleSheets[r].deleteRule(i),!0):css_rules[i];while(css_rules[++i])}}return!1}function add_css(e,t){return e=e.toLowerCase(),t=t||0,!document.styleSheets||get_css(e,t)?!1:(document.styleSheets[t].addRule?document.styleSheets[t].addRule(e,null,0):document.styleSheets[t].insertRule(e+" { }",0),get_css(e))}function get_sheet_num(e){if(!document.styleSheets)return!1;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].href&&document.styleSheets[t].href.toString().match(e))return t;return!1}function remove_css(e,t){return get_css(e,t,!0)}function add_sheet(e){if(document.createStyleSheet)document.createStyleSheet(e);else{var t="@import url(' "+e+" ');",s=document.createElement("link");s.rel="stylesheet",s.href="data:text/css,"+escape(t),document.getElementsByTagName("head")[0].appendChild(s)}}function Sarissa(){}function tree_component(){return"undefined"==typeof tree_component.inst&&(tree_component.cntr=0,tree_component.inst=new Array,tree_component.drop=new Array,tree_component.focusInst=function(){return tree_component.inst[tree_component.focused]},tree_component.mousedown=function(e){var t=tree_component.focusInst();if(t){var s=jQuery(e.target);return tree_component.drop.length&&s.is("."+tree_component.drop.join(", ."))?(t.drag=jQuery("<li id='dragged' class='dragged foreign "+e.target.className+"'><a href='#'>"+s.text()+"</a></li>"),t._drag=t.drag,t.isdown=!0,t.foreign=s,s.blur(),e.preventDefault(),e.stopPropagation(),!1):(e.stopPropagation(),!0)}},tree_component.mouseup=function(e){var t=tree_component.focusInst();if(t){if(tree_component.to&&clearTimeout(tree_component.to),tree_component.sto&&clearTimeout(tree_component.sto),t.foreign===!1&&t.drag&&t.drag.parentNode&&t.drag.parentNode==jQuery(t.container).children("ul:eq(0)").get(0)){if(jQuery(t.drag).remove(),t.moveType){var s=tree_component.inst[jQuery(t.moveRef).parents(".tree:eq(0)").attr("id")];s&&s.moved(t.container.find("li.dragged"),t.moveRef,t.moveType,!1,"on"==t.settings.rules.drag_copy||"ctrl"==t.settings.rules.drag_copy&&e.ctrlKey)}t.moveType=!1,t.moveRef=!1}if(t.drag&&t.foreign!==!1){if(jQuery(t.drag).remove(),t.moveType){var s=tree_component.inst[jQuery(t.moveRef).parents(".tree:eq(0)").attr("id")];s&&s.settings.callback.ondrop.call(null,t.foreign.get(0),t.get_node(t.moveRef).get(0),t.moveType,t)}t.foreign=!1,t.moveType=!1,t.moveRef=!1}return jQuery("#marker").hide(),t._drag=!1,t.drag=!1,t.isdown=!1,t.appended=!1,t.container.find("li.dragged").removeClass("dragged"),e.preventDefault(),e.stopPropagation(),!1}},tree_component.mousemove=function(e){var t=tree_component.focusInst();if(t){if(t.locked)return t.error("LOCKED");if(t.isdown){if(tree_component.to&&clearTimeout(tree_component.to),!t.appended){t.container.children("ul:eq(0)").append(t.drag);var s=jQuery(t.drag).offsetParent();s.is("html")&&(s=jQuery("body")),t.po=s.offset(),t.appended=!0}if(jQuery(t.drag).css({left:e.pageX-t.po.left-(t.settings.ui.rtl?jQuery(t.drag).width():-5),top:e.pageY-t.po.top+(jQuery.browser.opera?t.container.scrollTop():0)+15}),"IMG"==e.target.tagName&&"marker"==e.target.id)return!1;var r=jQuery(e.target).parents(".tree:eq(0)");if(0==r.size())return tree_component.sto&&clearTimeout(tree_component.sto),0==jQuery(t.drag).children("IMG").size()&&jQuery(t.drag).append("<img class='removeicon' style='position:absolute; "+(t.settings.ui.rtl?"right":"left")+":4px; top:0px;' src='"+t.settings.ui.theme_path+"default/remove.gif' />"),t.moveType=!1,t.moveRef=!1,jQuery("#marker").hide(),!1;if(tree_component.inst[r.attr("id")].off_height(),!(t.foreign!==!1||r.get(0)==t.container.get(0)||t.settings.rules.multitree&&tree_component.inst[r.attr("id")].settings.rules.multitree))return 0==jQuery(t.drag).children("IMG").size()&&jQuery(t.drag).append("<img class='removeicon' style='position:absolute; "+(t.settings.ui.rtl?"right":"left")+":4px; top:0px;' src='"+t.settings.ui.theme_path+"default/remove.gif' />"),t.moveType=!1,t.moveRef=!1,jQuery("#marker").hide(),!1;tree_component.sto&&clearTimeout(tree_component.sto),tree_component.sto=setTimeout(function(){tree_component.inst[r.attr("id")].scrollCheck(e.pageX,e.pageY)},50);var i=!1,n=r.scrollTop();if("A"==e.target.tagName&&"title"==e.target.className){if(jQuery(e.target).is("#dragged"))return!1;var a={x:jQuery(e.target).offset().left-1,y:e.pageY-tree_component.inst[r.attr("id")].offset.top};r.hasClass("rtl")&&(a.x+=jQuery(e.target).width()-8),(a.y+n)%t.li_height<t.li_height/3+1?(i="before",a.y=e.pageY-(a.y+n)%t.li_height-2):(a.y+n)%t.li_height>2*t.li_height/3-1?(i="after",a.y=e.pageY-(a.y+n)%t.li_height+t.li_height-2):(i="inside",a.x-=2,r.hasClass("rtl")&&(a.x+=36),a.y=e.pageY-(a.y+n)%t.li_height+Math.floor(t.li_height/2)-2,t.get_node(e.target).hasClass("closed")&&(tree_component.to=setTimeout(function(){t.open_branch(t.get_node(e.target))},500))),tree_component.inst[r.attr("id")].checkMove(t.container.find("li.dragged"),jQuery(e.target),i)?("inside"==i?jQuery("#marker").attr("src",t.settings.ui.theme_path+"default/plus.gif").width(14):r.hasClass("rtl")?jQuery("#marker").attr("src",t.settings.ui.theme_path+"default/marker_rtl.gif").width(40):jQuery("#marker").attr("src",t.settings.ui.theme_path+"default/marker.gif").width(40),t.moveType=i,t.moveRef=e.target,jQuery(t.drag).children("IMG").remove(),jQuery("#marker").css({left:a.x-1,top:a.y-2}).show()):(0==jQuery(t.drag).children("IMG").size()&&jQuery(t.drag).append("<img class='removeicon' style='position:absolute; "+(t.settings.ui.rtl?"right:0px;":"left:4px;")+" top:0px;' src='"+t.settings.ui.theme_path+"default/remove.gif' />"),t.moveType=!1,t.moveRef=!1,jQuery("#marker").hide())}else 0==jQuery(t.drag).children("IMG").size()&&jQuery(t.drag).append("<img class='removeicon' style='position:absolute; "+(t.settings.ui.rtl?"right:0px;":"left:4px;")+" top:0px;' src='"+t.settings.ui.theme_path+"default/remove.gif' />"),t.moveType=!1,t.moveRef=!1,jQuery("#marker").hide();return e.preventDefault(),e.stopPropagation(),!1}return!0}}),{cntr:tree_component.cntr++,settings:{data:{type:"predefined",method:"GET",async:!1,async_data:function(e){return{id:jQuery(e).attr("id")||0}},url:!1,json:!1},selected:!1,opened:[],languages:[],path:!1,cookies:!1,ui:{dots:!0,rtl:!1,animation:0,hover_mode:!0,scroll_spd:4,theme_path:!1,theme_name:"default",context:[{id:"create",label:"Create",icon:"create.png",visible:function(e,t){return 1!=e.length?!1:t.check("creatable",e)},action:function(e,t){t.create(!1,e)}},"separator",{id:"rename",label:"Rename",icon:"rename.png",visible:function(e,t){return 1!=e.length?!1:t.check("renameable",e)},action:function(e,t){t.rename()}},{id:"delete",label:"Delete",icon:"remove.gif",visible:function(e,t){return t.check("deletable",e)},action:function(e,t){e.each(function(){t.remove(this)})}}]},rules:{multiple:!1,metadata:!1,type_attr:"rel",multitree:!1,createat:"bottom",use_inline:!1,clickable:"all",renameable:"all",deletable:"all",creatable:"all",draggable:"none",dragrules:"all",drag_copy:!1,droppable:[]},lang:{new_node:"New folder",loading:"Loading ..."},callback:{beforechange:function(e,t){return!0},beforemove:function(e,t,s,r){return!0},beforecreate:function(e,t,s,r){return!0},beforerename:function(e,t,s){return!0},beforedelete:function(e,t){return!0},onchange:function(e,t){},onrename:function(e,t,s){},onmove:function(e,t,s,r){},oncopy:function(e,t,s,r){},oncreate:function(e,t,s,r){},ondelete:function(e,t){},onopen:function(e,t){},onclose:function(e,t){},error:function(e,t){},ondblclk:function(e,t){t.toggle_branch.call(t,e),t.select_branch.call(t,e)},onrgtclk:function(e,t,s){},onload:function(e){},onfocus:function(e){},ondrop:function(e,t,s,r){}}},init:function(e,t){var s=this;if(this.container=jQuery(e),0==this.container.size)return void alert("Invalid container node!");if(tree_component.inst[this.cntr]=this,this.container.attr("id")||this.container.attr("id","jstree_"+this.cntr),tree_component.inst[this.container.attr("id")]=tree_component.inst[this.cntr],tree_component.focused=this.cntr,t&&t.cookies&&(this.settings.cookies=jQuery.extend({},this.settings.cookies,t.cookies),delete t.cookies,this.settings.cookies.opts||(this.settings.cookies.opts={})),t&&t.callback&&(this.settings.callback=jQuery.extend({},this.settings.callback,t.callback),delete t.callback),t&&t.data&&(this.settings.data=jQuery.extend({},this.settings.data,t.data),delete t.data),t&&t.ui&&(this.settings.ui=jQuery.extend({},this.settings.ui,t.ui),delete t.ui),t&&t.rules&&(this.settings.rules=jQuery.extend({},this.settings.rules,t.rules),delete t.rules),t&&t.lang&&(this.settings.lang=jQuery.extend({},this.settings.lang,t.lang),delete t.lang),this.settings=jQuery.extend({},this.settings,t),0==this.settings.path?(this.path="",jQuery("script").each(function(){this.src.toString().match(/tree_component.*?js.*$/)&&(s.path=this.src.toString().replace(/tree_component.*?js.*$/,""))})):this.path=this.settings.path,this.current_lang=this.settings.languages&&this.settings.languages.length?this.settings.languages[0]:!1,this.settings.languages&&this.settings.languages.length){this.sn=get_sheet_num("tree_component.css");for(var r=!1,n=this.container.attr("id")?"#"+this.container.attr("id"):".tree",a=0;a<this.settings.languages.length;a++)r=add_css(n+" ."+this.settings.languages[a],this.sn),r!==!1&&(r.style.display=this.settings.languages[a]==this.current_lang?"inline":"none")}if(this.settings.rules.droppable.length)for(i in this.settings.rules.droppable)tree_component.drop.push(this.settings.rules.droppable[i]),tree_component.drop=jQuery.unique(tree_component.drop);if(this.settings.ui.theme_path===!1&&(this.settings.ui.theme_path=this.path+"themes/"),this.theme=this.settings.ui.theme_path+s.settings.ui.theme_name+"/",add_sheet(s.settings.ui.theme_path+"default/style.css"),"default"!=this.settings.ui.theme_name&&add_sheet(s.theme+"style.css"),this.container.addClass("tree"),this.settings.ui.rtl&&this.container.addClass("rtl"),this.settings.rules.multiple&&(this.selected_arr=[]),this.offset=!1,0==this.settings.ui.dots&&this.container.addClass("no_dots"),this.context=!1,0!=this.settings.ui.context){var o='<div class="context">';for(i in this.settings.ui.context)if("separator"!=this.settings.ui.context[i]){var l="";this.settings.ui.context[i].icon&&(l="background-image:url('"+(-1==this.settings.ui.context[i].icon.indexOf("/")?this.theme+this.settings.ui.context[i].icon:this.settings.ui.context[i].icon)+"');"),o+='<a rel="'+this.settings.ui.context[i].id+'" href="#" style="'+l+'">'+this.settings.ui.context[i].label+"</a>"}else o+="<span class='separator'>&nbsp;</span>";o+="</div>",this.context=jQuery(o),this.context.hide(),this.context.append=!1}if(this.hovered=!1,this.locked=!1,"none"!=this.settings.rules.draggable&&"none"!=this.settings.rules.dragrules){var s=this;jQuery("<img>").attr({id:"marker",src:s.settings.ui.theme_path+"default/marker.gif"}).css({height:"8px",width:"42px",display:"block",position:"absolute",left:"30px",top:"30px",zIndex:"1000"}).hide().appendTo("body")}this.refresh(),this.attachEvents(),this.focus()},off_height:function(){if(this.offset===!1){this.container.css({position:"relative"}),this.offset=this.container.offset();var e=0;e=parseInt(jQuery.css(this.container.get(0),"paddingTop",!0),10),e&&(this.offset.top+=e),e=parseInt(jQuery.css(this.container.get(0),"borderTopWidth",!0),10),e&&(this.offset.top+=e),this.container.css({position:""})}if(!this.li_height){var e=this.container.find("ul li:eq(0)");this.li_height=e.height(),e.children("ul:eq(0)").size()&&(this.li_height-=e.children("ul:eq(0)").height()),this.li_height||(this.li_height=18)}},refresh:function(e){if(this.locked)return this.error("LOCKED");var t=this;if(this.opened=Array(),this.settings.cookies&&jQuery.cookie(this.settings.cookies.prefix+"_open")){var s=jQuery.cookie(this.settings.cookies.prefix+"_open"),r=s.split(",");jQuery.each(r,function(){t.opened.push("#"+this.replace(/^#/,""))}),this.settings.opened=!1}else 0!=this.settings.opened?(jQuery.each(this.settings.opened,function(e,s){t.opened.push("#"+this.replace(/^#/,""))}),this.settings.opened=!1):this.container.find("li.open").each(function(e){t.opened.push("#"+this.id)});if(this.selected)this.settings.selected=Array(),this.selected_arr?jQuery.each(this.selected_arr,function(){t.settings.selected.push("#"+this.attr("id"))}):this.settings.selected.push("#"+this.selected.attr("id"));else if(this.settings.selected!==!1){var r=Array();"object"==(typeof this.settings.selected).toLowerCase()?jQuery.each(this.settings.selected,function(){r.push("#"+this.replace(/^#/,""))}):r.push("#"+this.settings.selected.replace(/^#/,"")),this.settings.selected=r}if(e&&this.settings.data.async)return this.opened=Array(),e=this.get_node(e),e.find("li.open").each(function(e){t.opened.push("#"+this.id)}),this.close_branch(e,!0),e.children("ul:eq(0)").html(""),this.open_branch(e,!0,function(){t.reselect.apply(t)});var i="tree-default";if("default"!=this.settings.ui.theme_name&&(i+=" tree-"+t.settings.ui.theme_name),"xml_flat"==this.settings.data.type||"xml_nested"==this.settings.data.type){this.scrtop=this.container.get(0).scrollTop;var n="xml_flat"==this.settings.data.type?"flat.xsl":"nested.xsl";return void this.container.getTransform(this.path+n,this.settings.data.url,{params:{theme_name:i,theme_path:t.theme},meth:t.settings.data.method,callback:function(){t.reselect.apply(t)}})}if("json"==this.settings.data.type)if(this.settings.data.json){var s="";if(this.settings.data.json.length)for(var a=0;a<this.settings.data.json.length;a++)s+=this.parseJSON(this.settings.data.json[a]);else s=this.parseJSON(this.settings.data.json);this.container.html("<ul class='"+i+"'>"+s+"</ul>"),this.container.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed"),this.container.find("li").not(".open").not(".closed").addClass("leaf"),this.reselect()}else{var t=this;jQuery.ajax({type:this.settings.data.method,url:this.settings.data.url,data:this.settings.data.async_data(!1),dataType:"json",success:function(e){var s="";if(e.length)for(var r=0;r<e.length;r++)s+=t.parseJSON(e[r]);else s=t.parseJSON(e);t.container.html("<ul class='"+i+"'>"+s+"</ul>"),t.container.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed"),t.container.find("li").not(".open").not(".closed").addClass("leaf"),t.reselect.apply(t)}})}else this.container.children("ul:eq(0)").attr("class",i),this.container.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed"),this.container.find("li").not(".open").not(".closed").addClass("leaf"),this.reselect()},parseJSON:function(e){var t="";t+="<li ";var s=!1;for(r in e.attributes)"class"==r?(t+=" class='"+e.attributes[r]+" ",("closed"==e.state||"open"==e.state)&&(t+=" "+e.state+" "),t+="' ",s=!0):t+=" "+r+"='"+e.attributes[r]+"' ";if(s||"closed"!=e.state&&"open"!=e.state||(t+=" class='"+e.state+"' "),t+=">",this.settings.languages.length)for(var r=0;r<this.settings.languages.length;r++){var i=[];if(i.href="#",i.style="",i["class"]=this.settings.languages[r],e.data[this.settings.languages[r]]&&"undefined"!=(typeof e.data[this.settings.languages[r]].attributes).toLowerCase())for(j in e.data[this.settings.languages[r]].attributes)"style"==j||"class"==j?i[j]+=" "+e.data[this.settings.languages[r]].attributes[j]:i[j]=e.data[this.settings.languages[r]].attributes[j];if(e.data[this.settings.languages[r]]&&e.data[this.settings.languages[r]].icon){var n=-1==e.data[this.settings.languages[r]].icon.indexOf("/")?this.theme+e.data[this.settings.languages[r]].icon:e.data[this.settings.languages[r]].icon;i.style+=" ; background-image:url('"+n+"'); "}t+="<a";for(j in i)t+=" "+j+'="'+i[j]+'" ';t+=">"+("undefined"!=(typeof e.data[this.settings.languages[r]].title).toLowerCase()?e.data[this.settings.languages[r]].title:e.data[this.settings.languages[r]])+"</a>"}else{var i=[];if(i.href="#",i.style="",i["class"]="","undefined"!=(typeof e.data.attributes).toLowerCase())for(r in e.data.attributes)"style"==r||"class"==r?i[r]+=" "+e.data.attributes[r]:i[r]=e.data.attributes[r];if(e.data.icon){var n=-1==e.data.icon.indexOf("/")?this.theme+e.data.icon:e.data.icon;i.style+=" ; background-image:url('"+n+"');"}t+="<a";for(r in i)t+=" "+r+'="'+i[r]+'" ';t+=">"+("undefined"!=(typeof e.data.title).toLowerCase()?e.data.title:e.data)+"</a>"}if(e.children&&e.children.length){t+="<ul>";for(var r=0;r<e.children.length;r++)t+=this.parseJSON(e.children[r]);t+="</ul>"}return t+="</li>"},getJSON:function(e,t,s,r){var n=this;if(e=e&&0!=jQuery(e).size()?jQuery(e):this.container.children("ul").children("li"),e.size()>1){var a=[];return e.each(function(){a.push(n.getJSON(this,t,s))}),a}t||(t=["id","rel","class"]),s||(s=[]);var o={attributes:{},data:!1};for(i in t)o.attributes[t[i]]=e.attr(t[i]);if(this.settings.languages.length){o.data={};for(i in this.settings.languages){var l=e.children("a."+this.settings.languages[i]);if(r||s.length||l.get(0).style.backgroundImage.toString().length){if(o.data[this.settings.languages[i]]={},o.data[this.settings.languages[i]].title=l.text(),l.get(0).style.backgroundImage.length&&(o.data[this.settings.languages[i]].icon=l.get(0).style.backgroundImage.replace("url(","").replace(")","")),s.length){o.data[this.settings.languages[i]].attributes={};for(j in s)o.data[this.settings.languages[i]].attributes[s[j]]=l.attr(s[j])}}else o.data[this.settings.languages[i]]=l.text()}}else{var l=e.children("a");if(r||s.length||l.get(0).style.backgroundImage.toString().length){if(o.data={},o.data.title=l.text(),l.get(0).style.backgroundImage.length&&(o.data.icon=l.get(0).style.backgroundImage.replace("url(","").replace(")","")),s.length){o.data.attributes={};for(j in s)o.data.attributes[s[j]]=l.attr(s[j])}}else o.data=l.text()}return e.children("ul").size()>0&&(o.children=[],e.children("ul").children("li").each(function(){o.children.push(n.getJSON(this,t,s))})),o},focus:function(){return this.locked?!1:void(tree_component.focused!=this.cntr&&(tree_component.focused=this.cntr,this.settings.callback.onfocus.call(null,this)))},show_context:function(e,t,s){var r=this.context.show().offsetParent();r.is("html")&&(r=jQuery("body")),r=r.offset(),this.context.css({left:t-r.left-(this.settings.ui.rtl?jQuery(this.context).width():-5),top:s-r.top+(jQuery.browser.opera?this.container.scrollTop():0)+15})},hide_context:function(){this.context.hide()},attachEvents:function(){var e=this;this.container.bind("mouseup",function(t){setTimeout(function(){e.focus.apply(e)},5)}).bind("click",function(e){return e.stopPropagation(),!0}).listen("click","li",function(t){e.toggle_branch.apply(e,[t.target]),t.stopPropagation()}).listen("click","a.title",function(t){return e.locked?(t.preventDefault(),t.target.blur(),e.error("LOCKED")):(e.select_branch.apply(e,[t.target,t.ctrlKey||"on"==e.settings.rules.multiple]),e.inp&&e.inp.blur(),t.preventDefault(),t.target.blur(),!1)}).listen("dblclick","a.title",function(t){return e.locked?(t.preventDefault(),t.stopPropagation(),t.target.blur(),e.error("LOCKED")):(e.settings.callback.ondblclk.call(null,e.get_node(t.target).get(0),e),t.preventDefault(),t.stopPropagation(),void t.target.blur())}).listen("contextmenu","a.title",function(t){if(e.locked)return t.target.blur(),e.error("LOCKED");if(e.settings.callback.onrgtclk.call(null,e.get_node(t.target).get(0),e,t),e.context){if(0==e.context.append){e.container.find("ul:eq(0)").append(e.context),e.context.append=!0;for(i in e.settings.ui.context)"separator"!=e.settings.ui.context[i]&&!function(){var t=e.settings.ui.context[i].action;e.context.children("[rel="+e.settings.ui.context[i].id+"]").bind("click",function(s){return t.call(null,e.selected_arr||e.selected,e),e.hide_context(),s.stopPropagation(),s.preventDefault(),!1})}()}var s=e.get_node(t.target);if(e.inp&&e.inp.blur(),s){s.children("a:eq(0)").hasClass("clicked")||(e.select_branch.apply(e,[t.target,t.ctrlKey||"on"==e.settings.rules.multiple]),t.target.blur()),e.context.children("li").show();var r=!1;for(i in e.settings.ui.context)"separator"!=e.settings.ui.context[i]&&(e.settings.ui.context[i].visible.call(null,e.selected_arr||e.selected,e)?r=!0:e.context.children("[rel="+e.settings.ui.context[i].id+"]").hide());return 1==r&&e.show_context(s,t.pageX,t.pageY),t.preventDefault(),t.stopPropagation(),!1}}return!0}).listen("mouseover","a.title",function(t){return e.locked?(t.preventDefault(),t.stopPropagation(),e.error("LOCKED")):void(e.settings.ui.hover_mode&&e.hovered!==!1&&"A"==t.target.tagName&&(e.hovered.children("a").removeClass("hover"),e.hovered=!1))}),"none"!=this.settings.rules.draggable&&"none"!=this.settings.rules.dragrules&&(this.container.listen("mousedown","a",function(t){if(e.focus.apply(e),e.locked)return e.error("LOCKED");var s=e.get_node(t.target);if(0!=e.settings.rules.multiple&&e.selected_arr.length>1&&s.children("a:eq(0)").hasClass("clicked")){var r=0;for(i in e.selected_arr)e.check("draggable",e.selected_arr[i])&&(e.selected_arr[i].addClass("dragged"),r++);r>0&&(e._drag=e.check("draggable",s)?s:e.container.find("li.dragged:eq(0)"),e.isdown=!0,e.drag=e._drag.get(0).cloneNode(!0),e.drag.id="dragged",jQuery(e.drag).children("a").html("Multiple selection").end().children("ul").remove())}else e.check("draggable",s)&&(e._drag=s,e.drag=s.get(0).cloneNode(!0),e.drag.id="dragged",e.isdown=!0,e.foreign=!1,s.addClass("dragged"));return s.blur(),t.preventDefault(),t.stopPropagation(),!1}),jQuery(document).bind("mousedown",tree_component.mousedown).bind("mouseup",tree_component.mouseup).bind("mousemove",tree_component.mousemove)),e.context&&jQuery(document).bind("mouseup",function(){e.hide_context()})},checkMove:function(e,t,s){if(this.locked)return this.error("LOCKED");var r=this;if(t.parents("li.dragged").size()>0||t.is(".dragged"))return this.error("MOVE: NODE OVER SELF");if(1==e.size()){var n=e.eq(0);if(n.hasClass("foreign")){if(0==this.settings.rules.droppable.length)return!1;if(!n.is("."+this.settings.rules.droppable.join(", .")))return!1;var a=!1;for(i in this.settings.rules.droppable)if(n.is("."+this.settings.rules.droppable[i])){this.settings.rules.metadata?(jQuery.metadata.setType("attr",this.settings.rules.metadata),n.attr(this.settings.rules.metadata,"type: '"+this.settings.rules.droppable[i]+"'")):n.attr(this.settings.rules.type_attr,this.settings.rules.droppable[i]),a=!0;break}if(!a)return!1}if(!this.check("dragrules",[n,s,t.parents("li:eq(0)")]))return this.error("MOVE: AGAINST DRAG RULES")}else{var a=!0;if(e.each(function(i){if(0==a)return!1;if(i>0)var n=e.eq(i-1),o="after";else var n=t,o=s;r.check.apply(r,["dragrules",[jQuery(this),o,n]])||(a=!1)}),0==a)return this.error("MOVE: AGAINST DRAG RULES")}if(this.settings.rules.use_inline&&this.settings.rules.metadata){var o=!1;if(o=t.parents("inside"==s?"li:eq(0)":"li:eq(1)"),o.size()){if("undefined"!=typeof o.metadata().valid_children){var l=o.metadata().valid_children,a=!0;if(e.each(function(e){return 0==a?!1:void(-1==jQuery.inArray(r.get_type(this),l)&&(a=!1))}),0==a)return this.error("MOVE: NOT A VALID CHILD")}if("undefined"!=typeof o.metadata().max_children&&o.children("ul:eq(0)").children("li").not(".dragged").size()+e.size()>o.metadata().max_children)return this.error("MOVE: MAX CHILDREN REACHED");var c=0;e.each(function(e){for(var e=1,t=jQuery(this);100>e&&(t=t.children("ul:eq(0)"),0!=t.size());)e++;c=Math.max(e,c)});var a=!0;if(o.parents("li").each(function(e){return 0==a?!1:void(jQuery(this).metadata().max_depth&&e+c>=jQuery(this).metadata().max_depth&&(a=!1))}),0==a)return this.error("MOVE: MAX_DEPTH REACHED")}}return!0},reselect:function(){var e=this;if(this.opened&&this.opened.length){for(var t=!1,s=0;s<this.opened.length;s++)if(this.settings.data.async){if(this.get_node(this.opened[s]).size()>0){t=!0;var r=this.opened[s];delete this.opened[s],this.open_branch(r,!0,function(){e.reselect.apply(e)})}}else this.open_branch(this.opened[s],!0);if(this.settings.data.async&&t)return;delete this.opened}this.scrtop&&(this.container.scrollTop(e.scrtop),delete this.scrtop),this.settings.selected!==!1&&(jQuery.each(this.settings.selected,function(t){e.select_branch(jQuery(e.settings.selected[t]),e.settings.rules.multiple!==!1&&t>0)}),this.settings.selected=!1),this.settings.callback.onload.call(null,e)},get_node:function(e){var e=jQuery(e);return e.is("li")?e:e.parents("li:eq(0)")},get_type:function(e){if(e=e?this.get_node(e):this.selected){if(this.settings.rules.metadata){jQuery.metadata.setType("attr",this.settings.rules.metadata);var t=e.metadata().type;if(t)return t}return e.attr(this.settings.rules.type_attr)}},scrollCheck:function(e,t){var s=this,r=s.container,i=s.offset,n=r.scrollTop(),a=r.scrollLeft(),o=r.get(0).scrollWidth>r.width()?40:20;t-i.top<20&&r.scrollTop(Math.max(n-s.settings.ui.scroll_spd,0)),r.height()-(t-i.top)<o&&r.scrollTop(n+s.settings.ui.scroll_spd),e-i.left<20&&r.scrollLeft(Math.max(a-s.settings.ui.scroll_spd,0)),r.width()-(e-i.left)<40&&r.scrollLeft(a+s.settings.ui.scroll_spd),(r.scrollLeft()!=a||r.scrollTop()!=n)&&(s.moveType=!1,s.moveRef=!1,jQuery("#marker").hide()),tree_component.sto=setTimeout(function(){s.scrollCheck(e,t)},50)},check:function(e,t){if(this.locked)return this.error("LOCKED");if("dragrules"!=e&&this.settings.rules.use_inline&&this.settings.rules.metadata&&(jQuery.metadata.setType("attr",this.settings.rules.metadata),"undefined"!=typeof this.get_node(t).metadata()[e]))return this.get_node(t).metadata()[e];if(!this.settings.rules[e])return!1;if("none"==this.settings.rules[e])return!1;if("all"==this.settings.rules[e])return!0;if("dragrules"==e){var s=new Array;s[0]=this.get_type(t[0]),s[1]=t[1],s[2]=this.get_type(t[2]);for(var r=0;r<this.settings.rules.dragrules.length;r++){var i=this.settings.rules.dragrules[r],n=0===i.indexOf("!")?!1:!0;n||(i=i.replace("!",""));for(var a=i.split(" "),o=0;3>o;o++)(a[o]==s[o]||"*"==a[o])&&(a[o]=!0);if(a[0]===!0&&a[1]===!0&&a[2]===!0)return n}return!1}return-1!=jQuery.inArray(this.get_type(t),this.settings.rules[e])?!0:!1},hover_branch:function(e){if(this.locked)return this.error("LOCKED");if(0==this.settings.ui.hover_mode)return this.select_branch(e);var t=this,e=t.get_node(e);if(!e.size())return this.error("HOVER: NOT A VALID NODE");if(!t.check("clickable",e))return this.error("SELECT: NODE NOT SELECTABLE");this.hovered&&this.hovered.children("A").removeClass("hover"),this.hovered=e,this.hovered.children("a").removeClass("hover").addClass("hover");var s=this.hovered.offset().top,r=this.container.offset().top,i=r+this.container.height(),n=this.container.get(0).scrollWidth>this.container.width()?40:20;r>s+5&&this.container.scrollTop(this.container.scrollTop()-(r-s+5)),s+n>i&&this.container.scrollTop(this.container.scrollTop()+(s+n-i))},select_branch:function(e,t){if(this.locked)return this.error("LOCKED");e||this.hovered===!1||(e=this.hovered);var s=this;if(e=s.get_node(e),!e.size())return this.error("SELECT: NOT A VALID NODE");if(e.children("a").removeClass("hover"),!s.check("clickable",e))return this.error("SELECT: NODE NOT SELECTABLE");if(s.settings.callback.beforechange.call(null,e.get(0),s)===!1)return this.error("SELECT: STOPPED BY USER");if(0!=this.settings.rules.multiple&&t&&e.children("a.clicked").size()>0)return this.deselect_branch(e);if(0!=this.settings.rules.multiple&&t&&this.selected_arr.push(e),0!=this.settings.rules.multiple&&!t){for(i in this.selected_arr)this.selected_arr[i].children("A").removeClass("clicked");this.selected_arr=[],this.selected_arr.push(e),this.selected&&this.selected.children("A").removeClass("clicked")}this.settings.rules.multiple||this.selected&&this.selected.children("A").removeClass("clicked"),this.selected=e,this.settings.ui.hover_mode&&this.hovered!==!1&&(this.hovered.children("A").removeClass("hover"),this.hovered=e),this.selected.children("a").removeClass("clicked").addClass("clicked").end().parents("li.closed").each(function(){s.open_branch(this,!0)});var r=this.selected.offset().top,n=this.container.offset().top,a=n+this.container.height(),o=this.container.get(0).scrollWidth>this.container.width()?40:20;n>r+5&&this.container.scrollTop(this.container.scrollTop()-(n-r+5)),r+o>a&&this.container.scrollTop(this.container.scrollTop()+(r+o-a)),this.set_cookie("selected"),this.settings.callback.onchange.call(null,this.selected.get(0),s)},deselect_branch:function(e){if(this.locked)return this.error("LOCKED");var t=this,e=this.get_node(e);e.children("a").removeClass("clicked"),0!=this.settings.rules.multiple&&this.selected_arr.length>1?(this.selected_arr=[],this.container.find("a.clicked").filter(":first-child").parent().each(function(){t.selected_arr.push(jQuery(this))}),e.get(0)==this.selected.get(0)&&(this.selected=this.selected_arr[0],this.set_cookie("selected"))):(0!=this.settings.rules.multiple&&(this.selected_arr=[]),this.selected=!1,this.set_cookie("selected")),this.selected?this.settings.callback.onchange.call(null,this.selected.get(0),t):this.settings.callback.onchange.call(null,!1,t)},toggle_branch:function(e){if(this.locked)return this.error("LOCKED");var e=this.get_node(e);return e.hasClass("closed")?this.open_branch(e):e.hasClass("open")?this.close_branch(e):void 0},open_branch:function(e,t,s){if(this.locked)return this.error("LOCKED");var e=this.get_node(e);if(!e.size())return this.error("OPEN: NO SUCH NODE");if(e.hasClass("leaf"))return this.error("OPEN: OPENING LEAF NODE");if(this.settings.data.async&&0==e.find("li").size()){var r=this;if(e.children("ul:eq(0)").remove().end().append("<ul><li class='last'><a style='background-image:url("+r.settings.ui.theme_path+"default/throbber.gif)' href='#'>"+(r.settings.lang.loading||"Loading ...")+"</a></li></ul>"),e.removeClass("closed").addClass("open"),"xml_flat"==this.settings.data.type||"xml_nested"==this.settings.data.type){var i="xml_flat"==this.settings.data.type?"flat.xsl":"nested.xsl",n=-1==this.settings.data.url.indexOf("?")?"?id="+encodeURIComponent(e.attr("id")):"&id="+encodeURIComponent(e.attr("id"));e.children("ul:eq(0)").getTransform(this.path+i,this.settings.data.url+n,{params:{theme_path:r.theme},meth:this.settings.data.method,repl:!0,callback:function(t,i){return t.length<15?(e.removeClass("closed").removeClass("open").addClass("leaf").children("ul").remove(),void(s&&s.call())):(r.open_branch.apply(r,[e]),void(s&&s.call()))}})}else jQuery.ajax({type:this.settings.data.method,url:this.settings.data.url,data:this.settings.data.async_data(e),dataType:"json",success:function(t,i){if(!t||0==t.length)return e.removeClass("closed").removeClass("open").addClass("leaf").children("ul").remove(),void(s&&s.call());var n="";if(t.length)for(var a=0;a<t.length;a++)n+=r.parseJSON(t[a]);else n=r.parseJSON(t);e.children("ul:eq(0)").replaceWith("<ul>"+n+"</ul>"),e.find("li:last-child").addClass("last").end().find("li:has(ul)").not(".open").addClass("closed"),e.find("li").not(".open").not(".closed").addClass("leaf"),r.open_branch.apply(r,[e]),s&&s.call()}});return!0}return!(parseInt(this.settings.ui.animation)>0)||t||jQuery.browser.msie&&jQuery.browser.version<7?(e.removeClass("closed").addClass("open"),s&&s.call()):(e.children("ul:eq(0)").css("display","none"),e.removeClass("closed").addClass("open"),e.children("ul:eq(0)").slideDown(parseInt(this.settings.ui.animation),function(){jQuery(this).css("display",""),s&&s.call()})),this.set_cookie("open"),this.settings.callback.onopen.call(null,e.get(0),this),!0},close_branch:function(e,t){if(this.locked)return this.error("LOCKED");var s=this,e=this.get_node(e);!(parseInt(this.settings.ui.animation)>0)||t||jQuery.browser.msie&&jQuery.browser.version<7||1!=e.children("ul:eq(0)").size()?(e.removeClass("open").addClass("closed"),
this.set_cookie("open")):e.children("ul:eq(0)").slideUp(parseInt(this.settings.ui.animation),function(){e.removeClass("open").addClass("closed"),s.set_cookie("open"),jQuery(this).css("display","")}),this.selected&&e.children("ul:eq(0)").find("a.clicked").size()>0&&(e.find("li:has(a.clicked)").each(function(){s.deselect_branch(this)}),0==e.children("a.clicked").size()&&this.select_branch(e,0!=this.settings.rules.multiple&&this.selected_arr.length>0)),this.settings.callback.onclose.call(null,e.get(0),this)},open_all:function(e){if(this.locked)return this.error("LOCKED");var t=this;e=e?jQuery(e):this.container,e.find("li.closed").each(function(){var e=this;t.open_branch.apply(t,[this,!0,function(){t.open_all.apply(t,[e])}])})},close_all:function(){if(this.locked)return this.error("LOCKED");var e=this;jQuery(this.container).find("li.open").each(function(){e.close_branch(this,!0)})},show_lang:function(e){if(this.locked)return this.error("LOCKED");if(this.settings.languages[e]==this.current_lang)return!0;var t=!1,s=this.container.attr("id")?"#"+this.container.attr("id"):".tree";return t=get_css(s+" ."+this.current_lang,this.sn),t!==!1&&(t.style.display="none"),t=get_css(s+" ."+this.settings.languages[e],this.sn),t!==!1&&(t.style.display="block"),this.current_lang=this.settings.languages[e],!0},cycle_lang:function(){if(this.locked)return this.error("LOCKED");var e=jQuery.inArray(this.current_lang,this.settings.languages);e++,e>this.settings.languages.length-1&&(e=0),this.show_lang(e)},create:function(e,t,s,r,n){if(this.locked)return this.error("LOCKED");if(t=t?this.get_node(t):this.selected,!t||!t.size())return this.error("CREATE: NO NODE SELECTED");if(!this.check("creatable",t))return this.error("CREATE: CANNOT CREATE IN NODE");var a=e||this.get_type(t)||"";if(this.settings.rules.use_inline&&this.settings.rules.metadata){if(jQuery.metadata.setType("attr",this.settings.rules.metadata),"undefined"!=typeof t.metadata().valid_children&&-1==jQuery.inArray(a,t.metadata().valid_children))return this.error("CREATE: NODE NOT A VALID CHILD");if("undefined"!=typeof t.metadata().max_children&&t.children("ul:eq(0)").children("li").size()+1>t.metadata().max_children)return this.error("CREATE: MAX_CHILDREN REACHED");var o=!0;if(t.parents("li").each(function(e){jQuery(this).metadata().max_depth&&e+1>=jQuery(this).metadata().max_depth&&(o=!1)}),!o)return this.error("CREATE: MAX_DEPTH REACHED")}if(t.hasClass("closed")){var l=this;return this.open_branch(t,!0,function(){l.create.apply(l,[e,t,s,r,n])})}$li=jQuery(n?"<li id='"+n+"' />":"<li />"),this.settings.rules.metadata?(jQuery.metadata.setType("attr",this.settings.rules.metadata),$li.attr(this.settings.rules.metadata,"type: '"+a+"'")):$li.attr(this.settings.rules.type_attr,a);var c="";if("string"==(typeof r).toLowerCase()&&(c=r,c=-1==c.indexOf("/")?this.theme+c:c),this.settings.languages.length)for(i=0;i<this.settings.languages.length;i++)val="string"==(typeof s).toLowerCase()?s:s&&s[i]?s[i]:this.settings.lang.new_node?"string"!=(typeof this.settings.lang.new_node).toLowerCase()&&this.settings.lang.new_node[i]?this.settings.lang.new_node[i]:this.settings.lang.new_node:"New folder","string"!=(typeof r).toLowerCase()&&r&&r[i]&&(c=r[i],c=-1==c.indexOf("/")?this.theme+c:c),$li.append("<a href='#'"+(c.length?" style='background-image:url(\""+c+"\");' ":" ")+"class='"+this.settings.languages[i]+"'>"+val+"</a>");else $li.append("<a href='#'"+(c.length?" style='background-image:url(\""+c+"\");' ":" ")+">"+(s||this.settings.lang.new_node||"New folder")+"</a>");return $li.addClass("leaf"),"top"==this.settings.rules.createat||0==t.children("ul").size()?this.moved($li,t.children("a:eq(0)"),"inside",!0):this.moved($li,t.children("ul:eq(0)").children("li:last").children("a:eq(0)"),"after",!0),this.select_branch($li.children("a:eq(0)")),s||this.rename(),$li},rename:function(){if(this.locked)return this.error("LOCKED");if(!this.selected)return this.error("RENAME: NO NODE SELECTED");var e=this;if(!this.check("renameable",this.selected))return this.error("RENAME: NODE NOT RENAMABLE");if(!this.settings.callback.beforerename.call(null,this.selected.get(0),e.current_lang,e))return this.error("RENAME: STOPPED BY USER");var t=this.selected;t=this.current_lang?t.find("a."+this.current_lang).get(0):t.find("a:first").get(0),last_value=t.innerHTML,e.inp=jQuery("<input type='text' />"),e.inp.val(last_value).bind("mousedown",function(e){e.stopPropagation()}).bind("mouseup",function(e){e.stopPropagation()}).bind("click",function(e){e.stopPropagation()}).bind("keyup",function(e){var t=e.keyCode||e.which;return 27==t?(this.value=last_value,void this.blur()):13==t?void this.blur():void 0}),e.inp.blur(function(s){""==this.value&&this.value==last_value,jQuery(t).html(jQuery(t).parent().find("input").eq(0).attr("value")).get(0).style.display="",jQuery(t).prevAll("span").remove(),this.value!=last_value&&e.settings.callback.onrename.call(null,e.get_node(t).get(0),e.current_lang,e),e.inp=!1});var s=jQuery("<span />").addClass(t.className).append(e.inp);s.attr("style",jQuery(t).attr("style")),t.style.display="none",jQuery(t).parent().prepend(s),e.inp.get(0).focus(),e.inp.get(0).select()},remove:function(e){if(this.locked)return this.error("LOCKED");if(e){if(e=this.get_node(e),e.size()){if(!this.check("deletable",e))return this.error("DELETE: NODE NOT DELETABLE");if(!this.settings.callback.beforedelete.call(null,e.get(0),r))return this.error("DELETE: STOPPED BY USER");$parent=e.parent(),e=e.remove(),$parent.children("li:last").addClass("last"),0==$parent.children("li").size()&&($li=$parent.parents("li:eq(0)"),$li.removeClass("open").removeClass("closed").addClass("leaf").children("ul").remove(),this.set_cookie("open")),this.settings.callback.ondelete.call(null,e,this)}}else{if(!this.selected)return this.error("DELETE: NO NODE SELECTED");if(!this.check("deletable",this.selected))return this.error("DELETE: NODE NOT DELETABLE");if(!this.settings.callback.beforedelete.call(null,this.selected.get(0),r))return this.error("DELETE: STOPPED BY USER");$parent=this.selected.parent();var e=this.selected;if(0==this.settings.rules.multiple||1==this.selected_arr.length)var t=!0,s=this.selected.prev("li:eq(0)").size()?this.selected.prev("li:eq(0)"):this.selected.parents("li:eq(0)");if(e=e.remove(),$parent.children("li:last").addClass("last"),0==$parent.children("li").size()&&($li=$parent.parents("li:eq(0)"),$li.removeClass("open").removeClass("closed").addClass("leaf").children("ul").remove(),this.set_cookie("open")),this.settings.callback.ondelete.call(null,e,this),t&&s&&this.select_branch(s),0!=this.settings.rules.multiple&&!t){var r=this;this.selected_arr=[],this.container.find("a.clicked").filter(":first-child").parent().each(function(){r.selected_arr.push(jQuery(this))}),this.selected_arr.length>0&&(this.selected=this.selected_arr[0],this.remove())}}},get_next:function(e){var t=this.hovered||this.selected;return t?t.hasClass("open")?e?this.select_branch(t.find("li:eq(0)")):this.hover_branch(t.find("li:eq(0)")):jQuery(t).nextAll("li").size()>0?e?this.select_branch(t.nextAll("li:eq(0)")):this.hover_branch(t.nextAll("li:eq(0)")):e?this.select_branch(t.parents("li").next("li").eq(0)):this.hover_branch(t.parents("li").next("li").eq(0)):void 0},get_prev:function(e){var t=this.hovered||this.selected;if(t){if(t.prev("li").size()){for(var t=t.prev("li").eq(0);t.hasClass("open");)t=t.children("ul:eq(0)").children("li:last");return e?this.select_branch(t):this.hover_branch(t)}return e?this.select_branch(t.parents("li:eq(0)")):this.hover_branch(t.parents("li:eq(0)"))}},get_left:function(e,t){if(this.settings.ui.rtl&&!t)return this.get_right(e,!0);var s=this.hovered||this.selected;if(s){if(!s.hasClass("open"))return e?this.select_branch(s.parents("li:eq(0)")):this.hover_branch(s.parents("li:eq(0)"));this.close_branch(s)}},get_right:function(e,t){if(this.settings.ui.rtl&&!t)return this.get_left(e,!0);var s=this.hovered||this.selected;if(s){if(!s.hasClass("closed"))return e?this.select_branch(s.find("li:eq(0)")):this.hover_branch(s.find("li:eq(0)"));this.open_branch(s)}},toggleDots:function(){this.container.toggleClass("no_dots")},set_cookie:function(e){if(this.settings.cookies===!1)return!1;switch(e){case"open":var t="";this.container.find("li.open").each(function(e){t+=this.id+","}),jQuery.cookie(this.settings.cookies.prefix+"_open",t.replace(/,$/gi,""),this.settings.cookies.opts)}},moved:function(e,t,s,r,n){var e=jQuery(e),a=jQuery(e).parents("ul:eq(0)"),o=jQuery(t);if(e.size()>1){var l=this,c=this.moved(e.eq(0),t,s,!1,n);return void e.each(function(e){0!=e&&(c=l.moved(this,c.children("a:eq(0)"),"after",!1,n))})}if(n&&(e=e.clone(),e.each(function(e){this.id=this.id+"_copy",jQuery(this).find("li").each(function(){this.id=this.id+"_copy"}),jQuery(this).find("a.clicked").removeClass("clicked")})),r){if(!this.settings.callback.beforecreate.call(null,this.get_node(e).get(0),this.get_node(t).get(0),s,this))return}else if(!this.settings.callback.beforemove.call(null,this.get_node(e).get(0),this.get_node(t).get(0),s,this))return;if(!r){var c=jQuery(e).parents(".tree:eq(0)");if(c.get(0)!=this.container.get(0)&&(c=tree_component.inst[c.attr("id")],c.settings.languages.length)){var d=[];if(0==this.settings.languages.length)d.push("."+c.current_lang);else for(i in this.settings.languages)for(j in c.settings.languages)this.settings.languages[i]==c.settings.languages[j]&&d.push("."+this.settings.languages[i]);if(0==d.length)return this.error("MOVE: NO COMMON LANGUAGES");e.find("a").removeClass("clicked").not(d.join(",")).remove()}}switch(s){case"before":o.parents("ul:eq(0)").children("li.last").removeClass("last"),o.parents("li:eq(0)").before(e.removeClass("last")),o.parents("ul:eq(0)").children("li:last").addClass("last");break;case"after":o.parents("ul:eq(0)").children("li.last").removeClass("last"),o.parents("li:eq(0)").after(e.removeClass("last")),o.parents("ul:eq(0)").children("li:last").addClass("last");break;case"inside":if(this.settings.data.async){var h=this.get_node(o);if(h.hasClass("closed")){var l=this;return this.open_branch(h,!0,function(){l.moved.apply(l,[e,t,s,r,n])})}}o.parents("li:eq(0)").children("ul:first").size()?"top"==this.settings.rules.createat?o.parents("li:eq(0)").children("ul:first").prepend(e.removeClass("last")).children("li:last").addClass("last"):o.parents("li:eq(0)").children("ul:first").children(".last").removeClass("last").end().append(e.removeClass("last")).children("li:last").addClass("last"):(e.addClass("last"),o.parents("li:eq(0)").append("<ul/>").removeClass("leaf").addClass("closed"),o.parents("li:eq(0)").children("ul:first").prepend(e)),this.settings.data.async||this.open_branch(o)}if(0==a.find("li").size()){var u=a.parent();u.removeClass("open").removeClass("closed").addClass("leaf").children("ul").remove(),u.parents("ul:eq(0)").children("li.last").removeClass("last").end().children("li:last").addClass("last"),this.set_cookie("open")}else a.children("li.last").removeClass("last"),a.children("li:last").addClass("last");return r&&"inside"!=s&&(t=this.get_node(t).parents("li:eq(0)")),n?this.settings.callback.oncopy.call(null,this.get_node(e).get(0),this.get_node(t).get(0),s,this):r?this.settings.callback.oncreate.call(null,this.get_node(e).get(0),this.get_node(t).get(0),this.settings.insertAt,this):this.settings.callback.onmove.call(null,this.get_node(e).get(0),this.get_node(t).get(0),s,this),e},error:function(e){return this.settings.callback.error.call(null,e,this),!1},lock:function(e){this.locked=e,this.locked?this.container.addClass("locked"):this.container.removeClass("locked")},cut:function(){return this.locked?this.error("LOCKED"):this.selected?(this.copy_nodes=!1,void(this.cut_nodes=this.container.find("a.clicked").filter(":first-child").parent())):this.error("CUT: NO NODE SELECTED")},copy:function(){return this.locked?this.error("LOCKED"):this.selected?(this.copy_nodes=this.container.find("a.clicked").filter(":first-child").parent(),void(this.cut_nodes=!1)):this.error("COPY: NO NODE SELECTED")},paste:function(){if(this.locked)return this.error("LOCKED");if(!this.selected)return this.error("PASTE: NO NODE SELECTED");if(!this.copy_nodes&&!this.cut_nodes)return this.error("PASTE: NOTHING TO DO");if(this.copy_nodes&&this.copy_nodes.size()){if(!this.checkMove(this.copy_nodes,this.selected.children("a:eq(0)"),"inside"))return!1;this.moved(this.copy_nodes,this.selected.children("a:eq(0)"),"inside",!1,!0),this.copy_nodes=!1}if(this.cut_nodes&&this.cut_nodes.size()){if(!this.checkMove(this.cut_nodes,this.selected.children("a:eq(0)"),"inside"))return!1;this.moved(this.cut_nodes,this.selected.children("a:eq(0)"),"inside"),this.cut_nodes=!1}},search:function(e){var t=this;if((!e||this.srch&&e!=this.srch)&&(this.srch="",this.srch_opn=!1,this.container.find("a.search").removeClass("search")),this.srch=e,e)if(this.settings.data.async)if(this.srch_opn)if(this.srch_opn.length){if(this.srch_opn&&this.srch_opn.length){for(var s=!1,r=0;r<this.srch_opn.length;r++)if(this.get_node("#"+this.srch_opn[r]).size()>0){s=!0;var i="#"+this.srch_opn[r];delete this.srch_opn[r],this.open_branch(i,!0,function(){t.search.apply(t,[e])})}s||(this.srch_opn=[],t.search.apply(t,[e]))}}else{var n="a";this.settings.languages.length&&(n+="."+this.current_lang),this.container.find(n+":contains('"+e+"')").addClass("search"),this.srch_opn=!1}else{var a=jQuery.extend({search:e},this.settings.data.async_data(!1));jQuery.ajax({type:this.settings.data.method,url:this.settings.data.url,data:a,dataType:"text",success:function(s){t.srch_opn=jQuery.unique(s.split(",")),t.search.apply(t,[e])}})}else{var n="a";this.settings.languages.length&&(n+="."+this.current_lang),this.container.find(n+":contains('"+e+"')").addClass("search").parents("li.closed").each(function(){t.open_branch(this,!0)})}},destroy:function(){try{var e=["click","dblclick","contextmenu","mouseover","mousedown"];for(i in e){var t=this.container.indexer(e[i]);t.stop(),jQuery.removeData(t.listener,t.event+".indexer")}}catch(s){}if(this.container.unbind(),this.container.removeClass("tree").children("ul").removeClass("tree-"+this.settings.ui.theme_name).find("li").removeClass("leaf").removeClass("open").removeClass("closed").removeClass("last").children("a").removeClass("clicked"),this.cntr==tree_component.focused)for(i in tree_component.inst)if(i!=this.cntr&&i!=this.container.attr("id")){tree_component.inst[i].focus();break}delete tree_component.inst[this.cntr],delete tree_component.inst[this.container.attr("id")],tree_component.cntr--}}}if(function(e){function t(s,r){e.extend(this,{ids:{},tags:{},listener:r,event:s}),this.id=t.instances.push(this)}function s(e,t,s){for(var r=0,i=e.length;i>r;r++)t.call(s,e[r],r)}function r(e,t){return e.push.apply(e,t),e}var i="indexer",n=e.event,a=n.special,o=e.listen=function(e,r,i,n){"object"!=typeof r&&(n=i,i=r,r=document),s(e.split(/\s+/),function(e){e=o.fixes[e]||e;var s=l(r,e)||l(r,e,new t(e,r));s.append(i,n),s.start()})},l=function(t,s,r){return e.data(t,s+"."+i,r)};e.fn[i]=function(e){return this[0]&&l(this[0],e)||null},e[i]=function(e){return l(document,e)},e.extend(o,{regex:/^((?:\w*?|\*))(?:([#.])([\w-]+))?$/,fixes:{focus:"focusin",blur:"focusout"},cache:function(e){this.caching=e}}),e.each(o.fixes,function(t,s){a[s]={setup:function(){return e.browser.msie?!1:void this.addEventListener(t,a[s].handler,!0)},teardown:function(){return e.browser.msie?!1:void this.removeEventListener(t,a[s].handler,!0)},handler:function(e){return arguments[0]=e=n.fix(e),e.type=s,n.handle.apply(this,arguments)}}}),e.fn.listen=function(e,t,s){return this.each(function(){o(e,this,t,s)})},t.instances=[],t.prototype={constructor:t,handle:function(e){var t=e.stopPropagation;e.stopPropagation=function(){e.stopped=1,t.apply(this,arguments)},l(this,e.type).parse(e),e.stopPropagation=t,t=e.data=null},on:0,bubbles:0,start:function(){var e=this;e.on||(n.add(e.listener,e.event,e.handle),e.on=1)},stop:function(){var e=this;e.on&&(n.remove(e.listener,e.event,e.handle),e.on=0)},cache:function(t,s){return e.data(t,"listenCache_"+this.id,s)},parse:function(e){var t,i=this,n=e.data||e.target,a=arguments;o.caching&&(t=i.cache(n))||(t=[],n.id&&i.ids[n.id]&&r(t,i.ids[n.id]),s([n.nodeName,"*"],function(e){var a=i.tags[e];a&&s((n.className+" *").split(" "),function(e){e&&a[e]&&r(t,a[e])})}),o.caching&&i.cache(n,t)),t[0]&&s(t,function(t){t.apply(n,a)===!1&&(e.preventDefault(),e.stopPropagation())}),!e.stopped&&(n=n.parentNode)&&("A"==n.nodeName||i.bubbles&&n!=i.listener)&&(e.data=n,i.parse(e)),t=a=n=null},append:function(e,t){var r=this;s(e.split(/\s*,\s*/),function(e){var s=o.regex.exec(e);if(!s)throw'$.listen > "'+e+'" is not a supported selector.';var i="#"==s[2]&&s[3],n=s[1].toUpperCase()||"*",a=s[3]||"*";i?(r.ids[i]||(r.ids[i]=[])).push(t):n&&(n=r.tags[n]=r.tags[n]||{},(n[a]||(n[a]=[])).push(t))})}},e(window).unload(function(){"function"==typeof t&&s(t.instances,function(t){t.stop(),e.removeData(t.listener,t.event+"."+i),t.ids=t.names=t.listener=null})})}(jQuery),Sarissa.VERSION="0.9.9.4",Sarissa.PARSED_OK="Document contains no parsing errors",Sarissa.PARSED_EMPTY="Document is empty",Sarissa.PARSED_UNKNOWN_ERROR="Not well-formed or other error",Sarissa.IS_ENABLED_TRANSFORM_NODE=!1,Sarissa.REMOTE_CALL_FLAG="gr.abiss.sarissa.REMOTE_CALL_FLAG",Sarissa._lastUniqueSuffix=0,Sarissa._getUniqueSuffix=function(){return Sarissa._lastUniqueSuffix++},Sarissa._SARISSA_IEPREFIX4XSLPARAM="",Sarissa._SARISSA_HAS_DOM_IMPLEMENTATION=document.implementation&&!0,Sarissa._SARISSA_HAS_DOM_CREATE_DOCUMENT=Sarissa._SARISSA_HAS_DOM_IMPLEMENTATION&&document.implementation.createDocument,Sarissa._SARISSA_HAS_DOM_FEATURE=Sarissa._SARISSA_HAS_DOM_IMPLEMENTATION&&document.implementation.hasFeature,Sarissa._SARISSA_IS_MOZ=Sarissa._SARISSA_HAS_DOM_CREATE_DOCUMENT&&Sarissa._SARISSA_HAS_DOM_FEATURE,Sarissa._SARISSA_IS_SAFARI=-1!=navigator.userAgent.toLowerCase().indexOf("safari")||-1!=navigator.userAgent.toLowerCase().indexOf("konqueror"),Sarissa._SARISSA_IS_SAFARI_OLD=Sarissa._SARISSA_IS_SAFARI&&parseInt((navigator.userAgent.match(/AppleWebKit\/(\d+)/)||{})[1],10)<420,Sarissa._SARISSA_IS_IE=document.all&&window.ActiveXObject&&navigator.userAgent.toLowerCase().indexOf("msie")>-1&&-1==navigator.userAgent.toLowerCase().indexOf("opera"),Sarissa._SARISSA_IS_OPERA=-1!=navigator.userAgent.toLowerCase().indexOf("opera"),window.Node&&Node.ELEMENT_NODE||(Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),Sarissa._SARISSA_IS_SAFARI_OLD){HTMLHtmlElement=document.createElement("html").constructor,Node=HTMLElement={},HTMLElement.prototype=HTMLHtmlElement.__proto__.__proto__,HTMLDocument=Document=document.constructor;var x=new DOMParser;XMLDocument=x.constructor,Element=x.parseFromString("<Single />","text/xml").documentElement.constructor,x=null}if("undefined"==typeof XMLDocument&&"undefined"!=typeof Document&&(XMLDocument=Document),Sarissa._SARISSA_IS_IE){Sarissa._SARISSA_IEPREFIX4XSLPARAM="xsl:";var _SARISSA_DOM_PROGID="",_SARISSA_XMLHTTP_PROGID="",_SARISSA_DOM_XMLWRITER="";Sarissa.pickRecentProgID=function(e){for(var t,s,r=!1,i=0;i<e.length&&!r;i++)try{{new ActiveXObject(e[i])}s=e[i],r=!0}catch(n){t=n}if(!r)throw"Could not retrieve a valid progID of Class: "+e[e.length-1]+". (original exception: "+t+")";return e=null,s},_SARISSA_DOM_PROGID=null,_SARISSA_THREADEDDOM_PROGID=null,_SARISSA_XSLTEMPLATE_PROGID=null,_SARISSA_XMLHTTP_PROGID=null,XMLHttpRequest=function(){return _SARISSA_XMLHTTP_PROGID||(_SARISSA_XMLHTTP_PROGID=Sarissa.pickRecentProgID(["Msxml2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"])),new ActiveXObject(_SARISSA_XMLHTTP_PROGID)},Sarissa.getDomDocument=function(e,t){_SARISSA_DOM_PROGID||(_SARISSA_DOM_PROGID=Sarissa.pickRecentProgID(["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"]));var s=new ActiveXObject(_SARISSA_DOM_PROGID);if(t){var r="";e&&(t.indexOf(":")>1?(r=t.substring(0,t.indexOf(":")),t=t.substring(t.indexOf(":")+1)):r="a"+Sarissa._getUniqueSuffix()),s.loadXML(e?"<"+r+":"+t+" xmlns:"+r+'="'+e+'" />':"<"+t+" />")}return s},Sarissa.getParseErrorText=function(e){var t=Sarissa.PARSED_OK;if(e&&e.parseError&&e.parseError.errorCode&&0!=e.parseError.errorCode){t="XML Parsing Error: "+e.parseError.reason+"\nLocation: "+e.parseError.url+"\nLine Number "+e.parseError.line+", Column "+e.parseError.linepos+":\n"+e.parseError.srcText+"\n";for(var s=0;s<e.parseError.linepos;s++)t+="-";t+="^\n"}else null===e.documentElement&&(t=Sarissa.PARSED_EMPTY);return t},Sarissa.setXpathNamespaces=function(e,t){e.setProperty("SelectionLanguage","XPath"),e.setProperty("SelectionNamespaces",t)},XSLTProcessor=function(){_SARISSA_XSLTEMPLATE_PROGID||(_SARISSA_XSLTEMPLATE_PROGID=Sarissa.pickRecentProgID(["Msxml2.XSLTemplate.6.0","MSXML2.XSLTemplate.3.0"])),this.template=new ActiveXObject(_SARISSA_XSLTEMPLATE_PROGID),this.processor=null},XSLTProcessor.prototype.importStylesheet=function(e){_SARISSA_THREADEDDOM_PROGID||(_SARISSA_THREADEDDOM_PROGID=Sarissa.pickRecentProgID(["MSXML2.FreeThreadedDOMDocument.6.0","MSXML2.FreeThreadedDOMDocument.3.0"])),e.setProperty("SelectionLanguage","XPath"),e.setProperty("SelectionNamespaces","xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");var t=new ActiveXObject(_SARISSA_THREADEDDOM_PROGID);try{t.resolveExternals=!0,t.setProperty("AllowDocumentFunction",!0)}catch(s){}e.url&&null!=e.selectSingleNode("//xsl:*[local-name() = 'import' or local-name() = 'include']")?(t.async=!1,t.load(e.url)):t.loadXML(e.xml),t.setProperty("SelectionNamespaces","xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");var r=t.selectSingleNode("//xsl:output");r?this.outputMethod=r.getAttribute("method"):delete this.outputMethod,this.template.stylesheet=t,this.processor=this.template.createProcessor(),this.paramsSet=[]},XSLTProcessor.prototype.transformToDocument=function(e){var t;if(_SARISSA_THREADEDDOM_PROGID)return this.processor.input=e,t=new ActiveXObject(_SARISSA_DOM_PROGID),this.processor.output=t,this.processor.transform(),t;_SARISSA_DOM_XMLWRITER||(_SARISSA_DOM_XMLWRITER=Sarissa.pickRecentProgID(["Msxml2.MXXMLWriter.6.0","Msxml2.MXXMLWriter.3.0","MSXML2.MXXMLWriter","MSXML.MXXMLWriter","Microsoft.XMLDOM"])),this.processor.input=e,t=new ActiveXObject(_SARISSA_DOM_XMLWRITER),this.processor.output=t,this.processor.transform();var s=new ActiveXObject(_SARISSA_DOM_PROGID);return s.loadXML(t.output+""),s},XSLTProcessor.prototype.transformToFragment=function(e,t){this.processor.input=e,this.processor.transform();var s,r=this.processor.output,i=t.createDocumentFragment();if("text"==this.outputMethod)i.appendChild(t.createTextNode(r));else if(t.body&&t.body.innerHTML)for(s=t.createElement("div"),s.innerHTML=r;s.hasChildNodes();)i.appendChild(s.firstChild);else{var n=new ActiveXObject(_SARISSA_DOM_PROGID);"<?xml"==r.substring(0,5)&&(r=r.substring(r.indexOf("?>")+2));var a="".concat("<my>",r,"</my>");for(n.loadXML(a),s=n.documentElement;s.hasChildNodes();)i.appendChild(s.firstChild)}return i},XSLTProcessor.prototype.setParameter=function(e,t,s){s=s?s:"",e?this.processor.addParameter(t,s,e):this.processor.addParameter(t,s),e=""+(e||""),this.paramsSet[e]||(this.paramsSet[e]=[]),this.paramsSet[e][t]=s},XSLTProcessor.prototype.getParameter=function(e,t){return e=""+(e||""),this.paramsSet[e]&&this.paramsSet[e][t]?this.paramsSet[e][t]:null},XSLTProcessor.prototype.clearParameters=function(){for(var e in this.paramsSet)for(var t in this.paramsSet[e])""!=e?this.processor.addParameter(t,"",e):this.processor.addParameter(t,"");this.paramsSet=[]}}else Sarissa._SARISSA_HAS_DOM_CREATE_DOCUMENT&&(Sarissa.__handleLoad__=function(e){Sarissa.__setReadyState__(e,4)},_sarissa_XMLDocument_onload=function(){Sarissa.__handleLoad__(this)},Sarissa.__setReadyState__=function(e,t){e.readyState=t,e.readystate=t,null!=e.onreadystatechange&&"function"==typeof e.onreadystatechange&&e.onreadystatechange()},Sarissa.getDomDocument=function(e,t){var s=document.implementation.createDocument(e?e:null,t?t:null,null);return s.onreadystatechange||(s.onreadystatechange=null),s.readyState||(s.readyState=0),s.addEventListener("load",_sarissa_XMLDocument_onload,!1),s},window.XMLDocument||(Sarissa.getDomDocument=Sarissa._SARISSA_HAS_DOM_FEATURE&&window.Document&&!Document.prototype.load&&document.implementation.hasFeature("LS","3.0")?function(e,t){var s=document.implementation.createDocument(e?e:null,t?t:null,null);return s}:function(e,t){var s=document.implementation.createDocument(e?e:null,t?t:null,null);return s&&(e||t)&&!s.documentElement&&s.appendChild(s.createElementNS(e,t)),s}));if(window.DOMParser||(Sarissa._SARISSA_IS_SAFARI?(DOMParser=function(){},DOMParser.prototype.parseFromString=function(e,t){var s=new XMLHttpRequest;return s.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(e),!1),s.send(null),s.responseXML}):Sarissa.getDomDocument&&Sarissa.getDomDocument()&&Sarissa.getDomDocument(null,"bar").xml&&(DOMParser=function(){},DOMParser.prototype.parseFromString=function(e,t){var s=Sarissa.getDomDocument();return s.loadXML(e),s})),"undefined"==typeof document.importNode&&Sarissa._SARISSA_IS_IE)try{document.importNode=function(e,t){var s;return"#text"==e.nodeName?document.createTextNode(e.data):(s=document.createElement("tbody"==e.nodeName||"tr"==e.nodeName?"table":"td"==e.nodeName?"tr":"option"==e.nodeName?"select":"div"),s.innerHTML=t?e.xml?e.xml:e.outerHTML:e.xml?e.cloneNode(!1).xml:e.cloneNode(!1).outerHTML,s.getElementsByTagName("*")[0])}}catch(e){}Sarissa.getParseErrorText||(Sarissa.getParseErrorText=function(e){var t=Sarissa.PARSED_OK;if(e&&e.documentElement)if("parsererror"==e.documentElement.tagName)t=e.documentElement.firstChild.data,t+="\n"+e.documentElement.firstChild.nextSibling.firstChild.data;else if(e.getElementsByTagName("parsererror").length>0){var s=e.getElementsByTagName("parsererror")[0];t=Sarissa.getText(s,!0)+"\n"}else e.parseError&&0!=e.parseError.errorCode&&(t=Sarissa.PARSED_UNKNOWN_ERROR);else t=Sarissa.PARSED_EMPTY;return t}),Sarissa.getText=function(e,t){for(var s="",r=e.childNodes,i=0;i<r.length;i++){var n=r[i],a=n.nodeType;a==Node.TEXT_NODE||a==Node.CDATA_SECTION_NODE?s+=n.data:t!==!0||a!=Node.ELEMENT_NODE&&a!=Node.DOCUMENT_NODE&&a!=Node.DOCUMENT_FRAGMENT_NODE||(s+=Sarissa.getText(n,!0))}return s},!window.XMLSerializer&&Sarissa.getDomDocument&&Sarissa.getDomDocument("","foo",null).xml&&(XMLSerializer=function(){},XMLSerializer.prototype.serializeToString=function(e){return e.xml}),Sarissa.stripTags=function(e){return e?e.replace(/<[^>]+>/g,""):e},Sarissa.clearChildNodes=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},Sarissa.copyChildNodes=function(e,t,s){if(Sarissa._SARISSA_IS_SAFARI&&t.nodeType==Node.DOCUMENT_NODE&&(t=t.documentElement),!e||!t)throw"Both source and destination nodes must be provided";s||Sarissa.clearChildNodes(t);var r,i=t.nodeType==Node.DOCUMENT_NODE?t:t.ownerDocument,n=e.childNodes;if("undefined"!=typeof i.importNode)for(r=0;r<n.length;r++)t.appendChild(i.importNode(n[r],!0));else for(r=0;r<n.length;r++)t.appendChild(n[r].cloneNode(!0))},Sarissa.moveChildNodes=function(e,t,s){if(!e||!t)throw"Both source and destination nodes must be provided";s||Sarissa.clearChildNodes(t);var r=e.childNodes;if(e.ownerDocument==t.ownerDocument)for(;e.firstChild;)t.appendChild(e.firstChild);else{var i,n=t.nodeType==Node.DOCUMENT_NODE?t:t.ownerDocument;if("undefined"!=typeof n.importNode)for(i=0;i<r.length;i++)t.appendChild(n.importNode(r[i],!0));else for(i=0;i<r.length;i++)t.appendChild(r[i].cloneNode(!0));Sarissa.clearChildNodes(e)}},Sarissa.xmlize=function(e,t,s){s=s?s:"";var r=s+"<"+t+">",i=!1;if(!(e instanceof Object)||e instanceof Number||e instanceof String||e instanceof Boolean||e instanceof Date)r+=Sarissa.escape(""+e),i=!0;else{r+="\n";var n=e instanceof Array;for(var a in e)r+=Sarissa.xmlize(e[a],n?'array-item key="'+a+'"':a,s+"   ");r+=s}return r+=-1!=t.indexOf(" ")?"</array-item>\n":"</"+t+">\n"},Sarissa.escape=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},Sarissa.unescape=function(e){return e.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")},Sarissa.updateCursor=function(e,t){e&&e.style&&void 0!=e.style.cursor&&(e.style.cursor=t)},Sarissa.updateContentFromURI=function(e,t,s,r,i){try{Sarissa.updateCursor(t,"wait");var n=new XMLHttpRequest;if(n.open("GET",e,!0),n.onreadystatechange=function(){if(4==n.readyState)try{var i=n.responseXML;if(!i||Sarissa.getParseErrorText(i)!=Sarissa.PARSED_OK)throw Sarissa.getParseErrorText(i);Sarissa.updateContentFromNode(n.responseXML,t,s),r&&r(e,t)}catch(a){if(!r)throw a;r(e,t,a)}},i){var a="Sat, 1 Jan 2000 00:00:00 GMT";n.setRequestHeader("If-Modified-Since",a)}n.send("")}catch(o){if(Sarissa.updateCursor(t,"auto"),!r)throw o;r(e,t,o)}},Sarissa.updateContentFromNode=function(e,t,s){try{Sarissa.updateCursor(t,"wait"),Sarissa.clearChildNodes(t);var r=e.nodeType==Node.DOCUMENT_NODE?e:e.ownerDocument;if(r.parseError&&0!=r.parseError.errorCode){var i=document.createElement("pre");i.appendChild(document.createTextNode(Sarissa.getParseErrorText(r))),t.appendChild(i)}else if(s&&(e=s.transformToDocument(e)),"textarea"==t.tagName.toLowerCase()||"input"==t.tagName.toLowerCase())t.value=(new XMLSerializer).serializeToString(e);else try{t.appendChild(t.ownerDocument.importNode(e,!0))}catch(n){t.innerHTML=(new XMLSerializer).serializeToString(e)}}catch(n){throw n}finally{Sarissa.updateCursor(t,"auto")}},Sarissa.formToQueryString=function(e){for(var t="",s=0;s<e.elements.length;s++){var r=e.elements[s],i=r.getAttribute(r.getAttribute("name")?"name":"id");if(i&&(!r.disabled||"hidden"==r.type))switch(r.type){case"hidden":case"text":case"textarea":case"password":t+=i+"="+encodeURIComponent(r.value)+"&";break;case"select-one":t+=i+"="+encodeURIComponent(r.options[r.selectedIndex].value)+"&";break;case"select-multiple":for(var n=0;n<r.length;n++){var a=r.options[n];a.selected===!0&&(t+=i+"[]="+encodeURIComponent(a.value)+"&")}break;case"checkbox":case"radio":r.checked&&(t+=i+"="+encodeURIComponent(r.value)+"&")}}return t.substr(0,t.length-1)},Sarissa.updateContentFromForm=function(e,t,s,r){try{Sarissa.updateCursor(t,"wait");var i=Sarissa.formToQueryString(e)+"&"+Sarissa.REMOTE_CALL_FLAG+"=true",n=new XMLHttpRequest,a=e.getAttribute("method")&&"get"==e.getAttribute("method").toLowerCase();a?n.open("GET",e.getAttribute("action")+"?"+i,!0):(n.open("POST",e.getAttribute("action"),!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.setRequestHeader("Content-length",i.length),n.setRequestHeader("Connection","close")),n.onreadystatechange=function(){try{if(4==n.readyState){var i=n.responseXML;if(!i||Sarissa.getParseErrorText(i)!=Sarissa.PARSED_OK)throw Sarissa.getParseErrorText(i);Sarissa.updateContentFromNode(n.responseXML,t,s),r&&r(e,t)}}catch(a){if(!r)throw a;r(e,t,a)}},n.send(a?"":i)}catch(o){if(Sarissa.updateCursor(t,"auto"),!r)throw o;r(e,t,o)}return!1},Sarissa.FUNCTION_NAME_REGEXP=new RegExp(""),Sarissa.getFunctionName=function(e,t){var s;return s||(t?(s="SarissaAnonymous"+Sarissa._getUniqueSuffix(),window[s]=e):s=null),s&&(window[s]=e),s},Sarissa.setRemoteJsonCallback=function(e,t,s){s||(s="callback");var r=Sarissa.getFunctionName(t,!0),i="sarissa_json_script_id_"+Sarissa._getUniqueSuffix(),n=document.getElementsByTagName("head")[0],a=document.createElement("script");return a.type="text/javascript",a.id=i,a.onload=function(){},e+=-1!=e.indexOf("?")?"&"+s+"="+r:"?"+s+"="+r,a.src=e,n.appendChild(a),i},Sarissa._SARISSA_HAS_DOM_FEATURE&&document.implementation.hasFeature("XPath","3.0")&&(SarissaNodeList=function(e){this.length=e},SarissaNodeList.prototype=[],SarissaNodeList.prototype.constructor=Array,SarissaNodeList.prototype.item=function(e){
return 0>e||e>=this.length?null:this[e]},SarissaNodeList.prototype.expr="",window.XMLDocument&&!XMLDocument.prototype.setProperty&&(XMLDocument.prototype.setProperty=function(e,t){}),Sarissa.setXpathNamespaces=function(e,t){e._sarissa_useCustomResolver=!0;var s=t.indexOf(" ")>-1?t.split(" "):[t];e._sarissa_xpathNamespaces=[];for(var r=0;r<s.length;r++){var i=s[r],n=i.indexOf(":"),a=i.indexOf("=");if(!(n>0&&a>n+1))throw"Bad format on namespace declaration(s) given";var o=i.substring(n+1,a),l=i.substring(a+2,i.length-1);e._sarissa_xpathNamespaces[o]=l}},XMLDocument.prototype._sarissa_useCustomResolver=!1,XMLDocument.prototype._sarissa_xpathNamespaces=[],XMLDocument.prototype.selectNodes=function(e,t,s){var r,i=this;r=this._sarissa_useCustomResolver?function(e){var t=i._sarissa_xpathNamespaces[e];if(t)return t;throw"No namespace URI found for prefix: '"+e+"'"}:this.createNSResolver(this.documentElement);var n=null;if(s)n=this.evaluate(e,t?t:this,r,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;else{var a=this.evaluate(e,t?t:this,r,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),o=new SarissaNodeList(a.snapshotLength);o.expr=e;for(var l=0;l<o.length;l++)o[l]=a.snapshotItem(l);n=o}return n},Element.prototype.selectNodes=function(e){var t=this.ownerDocument;if(t.selectNodes)return t.selectNodes(e,this);throw"Method selectNodes is only supported by XML Elements"},XMLDocument.prototype.selectSingleNode=function(e,t){var s=t?t:null;return this.selectNodes(e,s,!0)},Element.prototype.selectSingleNode=function(e){var t=this.ownerDocument;if(t.selectSingleNode)return t.selectSingleNode(e,this);throw"Method selectNodes is only supported by XML Elements"},Sarissa.IS_ENABLED_SELECT_NODES=!0);var xslTransform={version:20071203,debug:!1,init:function(){try{parseFloat(jQuery.fn.jquery)>=1}catch(e){alert("xslTransform requires jQuery 1.0.4 or greater ... please load it prior to xslTransform")}try{}catch(e){alert("Missing Sarissa ... please load it prior to xslTransform")}jQuery.log||(jQuery.log=function(){},jQuery.fn.debug=function(){}),this.debug&&jQuery.log("xslTransform:init(): version "+xslTransform.version)},XMLSerializer:new XMLSerializer,serialize:function(e){return this.debug&&jQuery.log("serialize(): received "+typeof e),"string"==typeof e?e:this.XMLSerializer.serializeToString(e)},load:function(e,t){this.debug&&jQuery.log("load(): received "+typeof e);var s;return"object"==typeof e?e:(s="<"==e.substring(0,1)?this.loadString(e):this.loadFile(e,t),s?(s.setProperty("SelectionNamespaces",'xmlns:xsl="http://www.w3.org/1999/XSL/Transform"'),s.setProperty("SelectionLanguage","XPath"),s):(this.debug&&$.log("Unable to load "+e),!1))},loadString:function(e){this.debug&&jQuery.log("loadString(): "+e+"::"+typeof e);var t=new DOMParser,s=t.parseFromString(e,"text/xml");return s?s:(this.debug&&jQuery.log("loadString(): parseFromString() failed"),!1)},loadFile:function(e,t){if(this.debug&&jQuery.log("loadFile(): "+e+"::"+typeof e),!e)return this.debug&&jQuery.log("ERROR: loadFile() missing url"),!1;var s;return this.xhrsuccess=function(e,t){return this.debug&&jQuery.log("loadFile() completed successfully ("+t+")"),s=e,!0},this.xhrerror=function(e,t){return window.DEBUG=!0,this.debug&&jQuery.log("loadFile() failed to load the requested file: ("+t+") - xml: "+e.responseXML+" - text: "+e.responseText),s=null,!1},t||(t="GET"),$.ajax({type:t,url:e,async:!1,success:this.xhrsuccess,error:this.xhrerror}),s?0==s.length?(this.debug&&jQuery.log("ERROR: document "+e+" loaded in loadFile() has no data"),!1):s:(this.debug&&jQuery.log("ERROR: document "+e+" not found (404), or unable to load"),!1)},transform:function(e,t,s){this.debug&&jQuery.log("transform(): "+e+"::"+t+"::"+s.toString()),s=s||{};var t={request:t,doc:this.load(t,s.meth)};s.xpath&&t.doc&&!jQuery.browser.msie&&(t.doc=t.doc.selectSingleNode(s.xpath.toString()),this.debug&&$.log("transform(): xpath has been run...resulting doc: "+this.serialize(t.doc)));var r={xsl:this.load(e,s.meth)};r.json=!1,s.json&&t.doc&&(r.json=t.doc.selectSingleNode(s.json.toString()));var i=new XSLTProcessor;if(i.importStylesheet(r.xsl),s.params&&i){this.debug&&jQuery.log("transform(): received xsl params: "+s.params.toString());for(key in s.params)i.setParameter(null,key.toString(),s.params[key].toString())}r.doc=i.transformToDocument(t.doc);var n=Sarissa.getParseErrorText(r.doc);return this.debug&&jQuery.log("transform(): Sarissa parse text: "+n),n!=Sarissa.PARSED_OK?(r.string=Sarissa.getParseErrorText(r.doc)+" :: using "+e+" => "+t.request,this.debug&&jQuery.log("transform(): error in transformation: "+Sarissa.getParseErrorText(r.doc)),r):(r.string=this.serialize(r.doc),r.scripts=jQuery("script",r.doc).text(),r)}};xslTransform.init(),jQuery.fn.getTransform=function(xsl,xml,options){var settings={append:!1,params:{},xpath:"",eval:!0,callback:"",json:!1,meth:"GET"};return jQuery.extend(settings,options),xslTransform.debug&&jQuery.log("getTransform: "+xsl+"::"+xml+"::"+settings.toString()),xsl&&xml?this.each(function(){var trans=xslTransform.transform(xsl,xml,settings),re=trans.string.match(/<\?xml.*?\?>/);re&&(trans.string=trans.string.replace(re,""),xslTransform.debug&&jQuery.log("getTransform(): found an xml declaration and removed it"));try{settings.append?$(this).append(trans.string):settings.repl?$(this).replaceWith(trans.string):$(this).html(trans.string)}catch(e){xslTransform.debug&&$.log("getTransform: error placing results of transform into element, falling back to innerHTML: "+e.toString()),$(this)[0].innerHTML=trans.string}if(settings.eval&&trans.scripts&&trans.scripts.length>0&&(xslTransform.debug&&jQuery.log("Found text/javascript in transformed result"),eval.call(window,trans.scripts)),settings.callback&&jQuery.isFunction(settings.callback)){var json=!1;settings.json&&trans.json&&eval("json = "+trans.json.firstChild.data),settings.callback.apply(window,[trans.string,json])}}):void(xslTransform.debug&&jQuery.log("getTransform: missing xsl or xml"))},function($){$.extend({metadata:{defaults:{type:"class",name:"metadata",cre:/({.*})/,single:"metadata"},setType:function(e,t){this.defaults.type=e,this.defaults.name=t},get:function(elem,opts){var settings=$.extend({},this.defaults,opts);settings.single.length||(settings.single="metadata");var data=$.data(elem,settings.single);if(data)return data;if(data="{}","class"==settings.type){var m=settings.cre.exec(elem.className);m&&(data=m[1])}else if("elem"==settings.type){if(!elem.getElementsByTagName)return void 0;var e=elem.getElementsByTagName(settings.name);e.length&&(data=$.trim(e[0].innerHTML))}else if(void 0!=elem.getAttribute){var attr=elem.getAttribute(settings.name);attr&&(data=attr)}return data.indexOf("{")<0&&(data="{"+data+"}"),data=eval("("+data+")"),$.data(elem,settings.single,data),data}}}),$.fn.metadata=function(e){return $.metadata.get(this[0],e)}}(jQuery),jQuery.cookie=function(e,t,s){if("undefined"==typeof t){var r=null;if(document.cookie&&""!=document.cookie)for(var i=document.cookie.split(";"),n=0;n<i.length;n++){var a=jQuery.trim(i[n]);if(a.substring(0,e.length+1)==e+"="){r=decodeURIComponent(a.substring(e.length+1));break}}return r}s=s||{},null===t&&(t="",s.expires=-1);var o="";if(s.expires&&("number"==typeof s.expires||s.expires.toUTCString)){var l;"number"==typeof s.expires?(l=new Date,l.setTime(l.getTime()+24*s.expires*60*60*1e3)):l=s.expires,o="; expires="+l.toUTCString()}var c=s.path?"; path="+s.path:"",d=s.domain?"; domain="+s.domain:"",h=s.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),o,c,d,h].join("")},jQuery.browser={},jQuery.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),jQuery.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),jQuery.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),jQuery.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()),jQuery.fn.tree=function(e){return this.each(function(){if(tree_component.inst&&tree_component.inst[jQuery(this).attr("id")]&&tree_component.inst[jQuery(this).attr("id")].destroy(),e!==!1){var t=new tree_component;t.init(this,e)}})};